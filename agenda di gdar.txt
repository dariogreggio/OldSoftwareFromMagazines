
0 REM AGENDA TOSTA DI GREGGIO DARIO _
1 REM CREATED BETWEEN 25-29 OF JUNE 1986
2 GOTO100
20 REM SUBR FILE
30 IFUI$=""THENUI$="§§§§§§§§§§":RETURN:ELSERETURN
100 FAST:DIMA$(301,6),C$(301),B$(6),C%(301):OP=1:FORI=1TO40:SP$=SP$+" ":NEXT
101 LO$="§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§§
§§§§§§§§"
102 TRAP20000
103 WINDOW0,0,79,24:BANK15
105 FORI=1TO8:KEYI,CHR$(132+I):NEXT
110 RESTORE110:FORI=0TO6:READB$(I):NEXT:DATA"ŒOME","√OGNOME","…NDIRIZZO","√ITTA'
","ŒO. DI TELEFONO","–ARTICOLARI","ŒOTE"
117 RESTORE117:FORI=0TO6:READRN(I):NEXT:DATA1,33,65,105,134,154,204
120 COLOR6,1:COLOR5,2
130 PRINT"ì
            "CHR$(27)"U":CHAR,23,8,"*  ¡ «†≈†Œ†ƒ†¡†  ‘†≈†Ã†≈†∆†œ†Œ†…†√†¡  *
135 CHAR,23,6,"***************************************":CHAR,23,7,"*":CHAR,61,7,
"*
137 CHAR,23,10,"***************************************":CHAR,23,9,"*":CHAR,61,9
,"*
140 CHAR,32,19,"√œ–Ÿ“…«»‘  1986  «.ƒAR
150 WINDOW30,12,54,17:PRINT
160 FORI=1TO110:FORK=1TO70:NEXT:PRINT"√“≈¡‘¡†ƒ¡†ƒ¡“…œ†«“≈««…œ ";:NEXT:SLEEP2
170 FORI=5TO45:FORK=1TO10:NEXT:POKE54784,34:POKE54785,I:POKE54784,35:POKE54785,9
1-I:NEXT
180 WINDOW0,12,79,24,1
190 FORI=45TO5STEP-1:FORK=1TO10:NEXT:POKE54784,34:POKE54785,I:POKE54784,35:POKE5
4785,91-I:NEXT
200 GOSUB10000:REM LOAD
205 WINDOW0,0,79,24,1
207 POKE208,0
210 CHAR,0,24," …Œ”≈“…”√…  √¡Œ√≈ÃÃ¡  “…√≈“√¡  Õœƒ…∆…√¡  œ“ƒ…Œ¡  √»…¡Õ¡  ??  ∆…Œ≈
   Õ≈Õ: 55000 ",1:WINDOW0,0,79,23,1
220 PRINT"…NSERISCI L'ORA CORRENTE:":A$="":INPUTA$:IFA$=""THENTI$="120000":EL
SETI$=LEFT$(A$+"000000",6)
230 PRINT"…NSERISCI LA DATA CORRENTE:":A$="":INPUTA$:DT$="01011986":MID$(DT$,1
,LEN(A$))=A$:DT$=LEFT$(DT$,2)+"/"+MID$(DT$,3,2)+"/"+RIGHT$(DT$,4)
300 REM MAIN
301 POKE2603,8
302 WINDOW0,0,79,23:G$="":PRINTCHR$(27)"U
305 PRINT"ì":DOUNTILG$>CHR$(132)ANDG$<CHR$(142)
310 PRINT"¡GENDA ‘ELEFONICA... ŒESSUNA OPERAZIONE IN CORSO"
320 PRINT"”ONO LE ORE "LEFT$(TI$,2)+":"+MID$(TI$,3,2)+"."+RIGHT$(TI$,2)" DEL "D
T$" , DOMENICA
330 GETG$:LOOP
340 PRINT"ì";:ONASC(G$)-132GOTO1000,2000,3000,4000,5000,6000,7000,8000
500 REM SUBR INPUT
510 T$="":TT=0:FL=TT
520 DO:GETKEYB$:IFB$<>CHR$(13)THENFL=1
530 IFASC(B$)=20ANDTT>0THENTT=TT-1:PRINT"ù §ùù";:T$=LEFT$(T$,LEN(T$)-1)
550 IF(B$<" "ORB$>"!")AND(B$<"¡"ORB$>"⁄")AND(B$<"-"ORB$>"_")AND(B$<"#"ORB$>"+")T
HEN580
560 PRINTB$" ù";:T$=T$+B$:TT=TT+1
580 LOOPUNTILASC(B$)=13ORTT=VA%
590 RETURN
1000 REM INSERT
1005 WINDOW0,0,79,24:CHAR,72,24,STR$(FRE(1)),1:WINDOW0,0,79,23,1
1010 PRINTTAB(24)"…Œ”≈“…Õ≈Œ‘œ ƒ… ’Œ Œ’œ÷œ ŒœÕ…Œ¡‘…÷œ":WINDOW1,2,78,23,1
1020 FORI=OPTO300
1022 WINDOW0,0,79,24:CHAR,72,24,STR$(FRE(1)),1:WINDOW1,2,78,23,1
1025 GOSUB1800
1030 PRINT""TAB(22);:VA%=26:GOSUB500:A$(I,0)=T$:PRINT
1040 PRINT""TAB(22);:VA%=31:GOSUB500:A$(I,1)=T$:PRINT
1042 IFT$=""THEN1050
1044 PO=ASC(LEFT$(T$,1))
1046 IFPO>191THEN1050
1048 A$(I,1)=CHR$(PO+128)+RIGHT$(T$,LEN(T$)-1)
1050 PRINT""TAB(22);:VA%=41:GOSUB500:A$(I,2)=T$:PRINT
1060 PRINT""TAB(22);:VA%=26:GOSUB500:A$(I,3)=T$:PRINT
1070 PRINT""TAB(22);:VA%=21:GOSUB500:A$(I,4)=T$:PRINT
1080 PRINT""TAB(22);:VA%=51:GOSUB500:A$(I,5)=T$:PRINT
1090 PRINT""TAB(22);:VA%=51:GOSUB500:A$(I,6)=T$:PRINT
1100 DO:CHAR,5,19,"√ONFERMI (SI/NO)"+CHR$(143)+"         ùùù":VA%=2:GOSUB500:LO
OPUNTILT$="SI"ORT$="NO":H$=T$:PRINT
1110 IFH$="NO"THENCHAR,5,19,"                                 ":GOTO1025
1120 IFA$(I,0)=""ANDA$(I,1)=""ANDA$(I,4)=""THENCHAR,5,19,"      ¡‘‘≈Œ⁄…œŒ≈:"+CH
R$(143)+" DATI INSUFFICIENTI":SLEEP2:GOTO1025
1125 FORX=0TO6:RECORD#1,I,RN(X):UI$=A$(I,X):GOSUB20:PRINT#1,UI$:NEXT
1130 CHAR,5,19,"< ∆1 > PER INSERIRE UN ALTRO NOMINATIVO"
1140 CHAR,5,20,"< ∆3 > PER PROSEGUIRE"
1150 DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135)
1160 IFA$=CHR$(135)THENOP=I+1:GOTO300:ELSENEXTI:GOTO300
1800 PRINT"ì∞¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿
¿¿¿¿¿¿¿¿¿Æ":GOTO1810
1805 PRINT"∞¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿
¿¿¿¿¿¿¿¿¿Æ"
1810 PRINT"›"TAB(77)"›"
1812 PRINTCHR$(27)"S";
1818 FORX=0TO6
1820 PRINT"›  "B$(X)LEFT$(" .....................",18-LEN(B$(X)))LEFT$(" "+LO$,5
3)TAB(77)"›"
1830 PRINT"›"TAB(77)"›"
1840 NEXTX
1850 PRINT"≠¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿
¿¿¿¿¿¿¿¿Ω
1860 RETURN
2000 REM DELETE
2005 WINDOW0,0,79,24:CHAR,72,24,STR$(FRE(1)),1:WINDOW0,0,79,23,1
2010 PRINTTAB(26)"√¡Œ√≈ÃÃ¡⁄…œŒ≈ ƒ… ’Œ ŒœÕ…Œ¡‘…÷œ":WINDOW0,2,w9,23,1
2020 CHAR,5,19,"…NSERISCI I DATI CONOSCIUTI:
2025 FORX=0TO6:A$(301,X)="":NEXT
2030 GOSUB1805
2040 PRINT""TAB(22);:VA%=26:GOSUB500:PRINT:IFFLTHENA$(301,0)=T$
2050 PRINT""TAB(22);:VA%=31:GOSUB500:PRINT:IFFLTHENA$(301,1)=T$
2052 IFT$=""THEN2060
2054 PO=ASC(T$)
2056 IFPO>191THEN2060
2058 A$(301,1)=CHR$(PO+128)+RIGHT$(T$,LEN(T$)-1)
2060 PRINT""TAB(22);:VA%=41:GOSUB500:PRINT:IFFLTHENA$(301,2)=T$
2070 PRINT""TAB(22);:VA%=26:GOSUB500:PRINT:IFFLTHENA$(301,3)=T$
2080 PRINT""TAB(22);:VA%=21:GOSUB500:PRINT:IFFLTHENA$(301,4)=T$
2090 PRINT""TAB(22);:VA%=51:GOSUB500:PRINT:IFFLTHENA$(301,5)=T$
2100 PRINT""TAB(22);:VA%=51:GOSUB500:PRINT:IFFLTHENA$(301,6)=T$
2110 DO:CHAR,5,19,CHR$(27)+"@√ONFERMI (SI/NO)"+CHR$(143)+"         ùùù":VA%=2:G
OSUB500:LOOPUNTILT$="SI"ORT$="NO":H$=T$:PRINT
2120 IFH$="NO"THENCHAR,5,19,"                                 ":GOTO2030
2130 FL=0:FORR=1TOOP
2140 IFA$(301,0)<>""THENIFA$(301,0)<>A$(R,0)THEN2210
2150 IFA$(301,1)<>""THENIFA$(301,1)<>A$(R,1)THEN2210
2160 IFA$(s01,2)<>""THENIFA$(301,2)<>A$(R,2)THEN2210
2170 IFA$(301,3)<>""THENIFA$(301,3)<>A$(R,3)THEN2210
2180 IFA$(301,4)<>""THENIFA$(301,4)<>A$(R,4)THEN2210
2190 IFA$(301,5)<>""THENIFA$(301,5)<>A$(R,5)THEN2210
2200 IFA$(301,6)<>""THENIFA$(301,6)<>A$(R,6)THEN2210
2202 FL=1:GOSUB2800
2204 CHAR,5,18,"< ∆1 > PER CANCELLARE":CHAR,5,19,"< ∆3 > PER PROSEGUIRE LA RICER
CA":DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135)
2206 IFA$=CHR$(135)THENCHAR,5,19,CHR$(27)+"@":ELSEGOTO2240
2210 NEXTR
2220 CHAR,5,19,"∆…Œ≈ ƒ≈ÃÃ¡ “…√≈“√¡               "
2225 IFFL=0THENCHAR,5,20,"¡‘‘≈Œ⁄…œŒ≈: "+CHR$(143)+"…L NOMINATIVO NON E' PRESENT
E
2230 SLEEP3:CHAR,5,19,CHR$(27)+"@"+"< ∆1 > PER RIPROVARE":CHAR,5,20,"< ∆3 > PER
PROSEGUIRE
2235 DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135):IFA$=CHR$(135)THEN300
2236 CHAR,5,19,"…NSERISCI I DATI CONOSCIUTI:"+CHR$(27)+"@"
2237 R=301:GOSUB2805:GOTO2040
2240 FL=1
2250 FORX=0TO6
2260 A$(Y,X)=A$(OP-1,X)
2270 NEXT:OP=OP-1:FORX=0TO6:RECORD#1,Y,RN(X):UI$=A$(Y,X):GOSUB20:PRINT#1,UI$:NEX
T
2280 CHAR,5,18,CHR$(27)+"@"+" 1 CANCELLATO(I)":CHAR,5,19,"< ∆1 > PER TERMINARE "
:CHAR,5,20,"< ∆3 > PER CANCELLARE ALTRI
2290 DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135):IFA$=CHR$(133)THEN300:ELSEC
HAR,5,18,CHR$(27)+"@":GOTO2210
2800 PRINT"ì∞¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿
¿¿¿¿¿¿¿¿¿Æ":GOTO2810
2805 PRINT"∞¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿
¿¿¿¿¿¿¿¿¿Æ
2810 PRINT"›"TAB(77)"›"
2812 PRINTCHR$(27)"S";
2815 FORX=0TO6
2820 PRINT"›  "B$(X)LEFT$(" ....................",18-LEN(B$(X)))" "A$(R,X)CHR$(-
32*(POS(0)>22))LEFT$(LO$,53-LEN(A$(R,X)))TAB(77)"›"
2830 PRINT"›"TAB(77)"›"
2840 NEXTX
2850 PRINT"≠¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿
¿¿¿¿¿¿¿¿Ω
2860 RETURN
2999 END
3000 REM SEARCH
3005 WINDOW0,0,79,24:CHAR,72,24,STR$(FRE(1)),1:WINDOW0,0,79,23,1
3010 PRINTTAB(27)"“…√≈“√¡ ƒ… ’Œ ŒœÕ…Œ¡‘…÷œ":WINDOW5,2,79,23,1
3020 PRINT"< ∆1 > PER RICERCARE ALCUNI NOMINATIVI
3030 PRINT"< ∆2 > PER STAMPARE ALCUNI NOMINATIVI
3040 PRINT"< ∆3 > PER VISUALIZZARE TUTTI I NOMINATIVI
3050 PRINT"< ∆4 > PER STAMPARE TUTTI I NOMINATIVI
3055 PRINT"< ∆5 > PER VISUALIZZARE TUTTI I NOMINATIVI IN ORDINE D'IMMISSIONE
3060 PRINT"< ∆6 > PER STAMPARE TUTTI I NOMINATIVI IN ORDINE D'IMMISSIONE
3062 PRINT"< ∆7 > PER TERMINARE
3065 WINDOW0,2,79,23
3070 DO:GETKEYA$:LOOPUNTILA$>CHR$(132)ANDA$<CHR$(140)
3080 ONASC(A$)-132GOTO3100,3400,3800,3850,3700,3750,3090
3090 PRINT"ì":GOTO300
3100 REM
3105 PR=0
3107 PRINT"ì":CHAR,5,19,"…NSERISCI LA CHIAVE DI RICERCA:
3109 FORX=0TO6:A$(301,X)="":NEXT
3110 GOSUB1805
3120 PRINT""TAB(22);:VA%=26:GOSUB500:PRINT:IFFLTHENA$(301,0)=T$
3130 PRINT""TAB(22);:VA%=31:GOSUB500:PRINT:IFFLTHENA$(301,1)=T$
3132 IFT$=""THEN3140
3134 PO=ASC(T$)
3136 IFPO>191THEN3140
3138 A$(301,1)=CHR$(PO+128)+RIGHT$(T$,LEN(T$)-1)
3140 PRINT""TAB(22);:VA%=41:GOSUB500:PRINT:IFFLTHENA$(301,2)=T$
3150 PRINT""TAB(22);:VA%=26:GOSUB500:PRINT:IFFLTHENA$(301,3)=T$
3160 PRINT""TAB(22);:VA%=21:GOSUB500:PRINT:IFFLTHENA$(301,4)=T$
3170 PRINT""TAB(22);:VA%=51:GOSUB500:PRINT:IFFLTHENA$(301,5)=T$
3180 PRINT""TAB(22);:VA%=51:GOSUB500:PRINT:IFFLTHENA$(301,6)=T$
3190 DO:CHAR,5,19,CHR$(27)+"@√ONFERMI (SI/NO)"+CHR$(143)+"         ùùù":VA%=2:G
OSUB500:LOOPUNTILT$="SI"ORT$="NO":H$=T$:PRINT
3200 IFH$="NO"THENCHAR,5,19,"                                 ":GOTO3110
3210 FL=0:FORR=1TOOP
3220 IFA$(301,0)<>""THENIFINSTR(A$(R,0),A$(301,0))=0THEN3290
3230 IFA$(301,1)<>""THENIFINSTR(A$(R,1),A$(301,1))=0THEN3290
3240 IFA$(301,2)<>""THENIFINSTR(A$(R,2),A$(301,2))=0THEN3290
3250 IFA$(301,3)<>""THENIFINSTR(A$(R,3),A$(301,3))=0THEN3290
3260 IFA$(301,4)<>""THENIFINSTR(A$(R,4),A$(301,4))=0THEN3290
3270 IFA$(301,5)<>""THENIFINSTR(A$(R,5),A$(301,5))=0THEN3290
3280 IFA$(301,6)<>""THENIFINSTR(A$(R,6),A$(301,6))=0THEN3290
3282 FL=1:IFPR=0THENGOSUB2800:ELSEOPEN4,4,7:CMD4:GOSUB2800:PRINT#4:CLOSE4
3284 CHAR,5,18,"< ∆1 > PER TERMINARE":CHAR,5,19,"< ∆3 > PER PROSEGUIRE LA RICERC
A":DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135)
3286 CHAR,5,18,CHR$(27)+"@":IFA$=CHR$(135)THENCHAR,5,19,CHR$(27)+"@":ELSEGOTO300

3290 NEXTR
3300 CHAR,5,19,"∆…Œ≈ ƒ≈ÃÃ¡ “…√≈“√¡               "
3305 IFFL=0THENCHAR,5,20,"¡‘‘≈Œ⁄…œŒ≈: "+CHR$(143)+"…L NOMINATIVO NON E' PRESENT
E
3310 SLEEP3:CHAR,5,19,CHR$(27)+"@< ∆1 > PER RIPROVARE":CHAR,5,20,"< ∆3 > PER PRO
SEGUIRE
3315 DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135):IFA$=CHR$(135)THEN300
3316 CHAR,5,19,"…NSERISCI LA CHIAVE DI RICERCA:"+CHR$(27)+"@"
3317 R=301:GOSUB2805:GOTO3120
3400 PR=1:GOTO3105
3700 PRINT"ì":CHAR,5,18,"< ∆1 > PER AVANZARE":CHAR,5,19,"< ∆3 > PER RETROCEDERE"
:CHAR,5,20,"< ∆5 > PER TERMINARE
3710 Y=1
3720 R=Y:GOSUB2805
3725 GETKEYA$:IFA$=CHR$(133)THENBEGIN:IFY<OP-1THENY=Y+1:GOTO3720:ELSEPRINT"";:BE
ND
3730 IFA$=CHR$(135)THENBEGIN:IFY>1THENY=Y-1:GOTO3720:ELSEPRINT"";:BEND
3740 IFA$=CHR$(137)THENBEGIN:IFPRTHENPRINT:CLOSE4:GOTO300:ELSEGOTO300:BEND
3745 GOTO3725
3750 OPEN4,4,7:CMD4:Y$=CHR$(16)
3760 GOTO3700
3800 PRINT"ì":CHAR,5,18,"< ∆1 > PER AVANZARE":CHAR,5,19,"< ∆3 > PER RETROCEDERE"
:CHAR,5,20,"< ∆5 > PER TERMINARE
3810 Y=1
3820 R=C%(Y):GOSUB2805
3825 GETKEYA$:IFA$=CHR$(133)THENBEGIN:IFY<OP-1THENY=Y+1:GOTO3820:ELSEPRINT"";:BE
ND
3830 IFA$=CHR$(135)THENBEGIN:IFY>1THENY=Y-1:GOTO3820:ELSEPRINT"";:BEND
3840 IFA$=CHR$(137)THENBEGIN:IFPRTHENPRINT:CLOSE4:GOTO300:ELSEGOTO300:BEND
3845 GOTO3825
3850 OPEN4,4,7:CMD4:Y$=CHR$(16)
3860 GOTO3800
3999 END
4000 REM MODIFY
4005 WINDOW0,0,79,24:CHAR,72,24,STR$(FRE(1)),1:WINDOW0,0,79,23,1
4010 PRINTTAB(28)"Õœƒ…∆…√»≈ ¡ƒ ’Œ ŒœÕ…Œ¡‘…÷œ":WINDOW0,2,79,23,1
4020 CHAR,5,19,"…NSERISCI I DATI CONOSCIUTI:
4025 FORX=0TO6:A$(301,X)="":NEXT
4030 GOSUB1805
4040 PRINT""TAB(22);:VA%=26:GOSUB500:PRINT:IFFLTHENA$(301,0)=T$
4050 PRINT""TAB(22);:VA%=31:GOSUB500:PRINT:IFFLTHENA$(301,1)=T$
4052 IFT$=""THEN4060
4054 PO=ASC(T$)
4056 IFPO>191THEN4060
4058 A$(301,1)=CHR$(PO+128)+RIGHT$(T$,LEN(T$)-1)
4060 PRINT""TAB(22);:VA%=41:GOSUB500:PRINT:IFFLTHENA$(301,2)=T$
4070 PRINT""TAB(22);:VA%=26:GOSUB500:PRINT:IFFLTHENA$(301,3)=T$
4080 PRINT""TAB(22);:VA%=21:GOSUB500:PRINT:IFFLTHENA$(301,4)=T$
4090 PRINT""TAB(22);:VA%=51:GOSUB500:PRINT:IFFLTHENA$(301,5)=T$
4100 PRINT""TAB(22);:VA%=51:GOSUB500:PRINT:IFFLTHENA$(301,6)=T$
4110 DO:CHAR,5,19,CHR$(27)+"@√ONFERMI (SI/NO)"+CHR$(143)+"         ùùù":VA%=2:G
OSUB500:LOOPUNTILT$="SI"ORT$="NO":H$=T$:PRINT
4120 IFH$="NO"THENCHAR,5,19,"                                 ":GOTO4030
4130 FL=0:FORR=1TOOP
4140 IFA$(301,0)<>""THENIFA$(301,0)<>A$(R,0)THEN4210
4150 IFA$(301,1)<>""THENIFA$(301,1)<>A$(R,1)THEN4210
4160 IFA$(301,2)<>""THENIFA$(301,2)<>A$(R,2)THEN4210
4170 IFA$(301,3)<>""THENIFA$(301,3)<>A$(R,3)THEN4210
4180 IFA$(301,4)<>""THENIFA$(301,4)<>A$(R,4)THEN4210
4190 IFA$(301,5)<>""THENIFA$(301,5)<>A$(R,5)THEN4210
4200 IFA$(301,6)<>""THENIFA$(301,6)<>A$(R,6)THEN4210
4202 FL=1:GOSUB2800
4204 CHAR,5,18,"< ∆1 > PER MODIFICARE":CHAR,5,19,"< ∆3 > PER PROSEGUIRE LA RICER
CA":DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135)
4206 CHAR,5,18,CHR$(27)+"@":IFA$=CHR$(135)THENCHAR,5,19,CHR$(27)+"@":ELSEGOTO424
0
4210 NEXTR
4220 CHAR,5,19,"∆…Œ≈ ƒ≈ÃÃ¡ “…√≈“√¡               "
4225 IFFL=0THENCHAR,5,20,"¡‘‘≈Œ⁄…œŒ≈: "+CHR$(143)+"…L NOMINATIVO NON E' PRESENT
E
4230 SLEEP3:CHAR,5,19,CHR$(27)+"@"+"< ∆1 > PER RIPROVARE":CHAR,5,20,"< ∆3 > PER
PROSEGUIRE
4235 DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135):IFA$=CHR$(135)THEN300
4236 CHAR,5,19,"…NSERISCI I DATI CONOSCIUTI:"+CHR$(27)+"@"
4237 R=301:GOSUB2805:GOTO4040
4240 CHAR,5,18,CHR$(27)+"@< ∆1 > PER ANDARE SU":CHAR,5,19,"< ∆3 > PER ANDARE GIU
":CHAR,5,20,"< ∆5 > PER TERMINARE LE MODIFICHE
4250 Y=0:FORI=0TO6:T$(I)=A$(R,I):TT(I)=LEN(T$(I)):NEXT
4260 CHAR,LEN(T$(Y))+22,Y*2+2,CHR$(0)
4270 DO:GETKEYB$
4280 IFASC(B$)=20ANDTT(Y)>0THENTT(Y)=TT(Y)-1:PRINT"ù §ùù";:T$(Y)=LEFT$(T$(Y),LEN
(T$(Y))-1)
4290 IF(B$<" "ORB$>"!")AND(B$<"¡"ORB$>"⁄")AND(B$<"-"ORB$>"_")AND(B$<"#"ORB$>"+")
THEN4305
4300 PRINTB$" ù";:T$(Y)=T$(Y)+B$:TT(Y)=TT(Y)+1
4305 IFB$=CHR$(133)THENBEGIN:IFY>0THENY=Y-1:CHAR,LEN(T$(Y))+22,Y*2+2,CHR$(0):ELS
EPRINT"";:BEND
4307 IFB$=CHR$(135)THENBEGIN:IFY<6THENY=Y+1:CHAR,LEN(T$(Y))+22,Y*2+2,CHR$(0):ELS
EPRINT"";:BEND
4310 LOOPUNTILASC(B$)=137
4320 FORY=0TO6:A$(R,Y)=T$(Y):RECORD#1,R,RN(Y):UI$=A$(R,Y):GOSUB20:PRINT#1,UI$:NE
XT
4330 CHAR,5,18,CHR$(27)+"@< ∆1 > PER PROSEGUIRE":CHAR,5,19,"< ∆3 > PER MODIFICAR
E ALTRI NOMINATIVI
4340 DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135):IFA$=CHR$(133)THEN300:ELSEG
OTO4000
4999 END
5000 REM SORT
5010 PRINTTAB(32)"œ“ƒ…Œ¡ Ã'¡“√»…÷…œ":WINDOW5,2,79,23,1
5020 PRINT" Ã'ARCHIVIO PUO' ESSERE ORDINATO SECONDO UNO QUALSIASI
5030 PRINT"DEI 7 CAMPI DISPONIBILI:
5040 FORY=0TO6
5050 PRINTTAB(4)"< ∆"CHR$(Y+49)" >  PER ORDINARE I NOMINATIVI SECONDO IL CAMPO "
B$(Y)
5060 NEXT
5065 PRINT"    < ∆8 >  PER TERMINARE
5070 PRINT"           ”√≈«Ã… !
5080 DO:GETKEYA$:LOOPUNTILA$>CHR$(132)ANDA$<CHR$(141)
5090 IFA$=CHR$(140)THEN300
5100 X=ASC(A$)-133:CHAR,5,13,"”CEGLI !  "+B$(X):POKE2603,8
5103 PRINT:PRINT"¡TTENDERE ...
5105 TF=TI
5110 FORI=1TOOP-1:C$(I)=A$(I,X):NEXT
5115 B=1
5120 DO:A=B:I=B:T$=C$(I)
5125 DO:I=I+1:IFC$(I)<T$THENT$=C$(I):A=I
5130 LOOPWHILEI<OP
5135 T$=C$(B):C$(B)=C$(A):C$(A)=T$
5140 B=B+1:LOOPWHILEB<OP
5145 FORI=0TOOP:C$(I)=C$(I+1):NEXT
5150 A=1:I=A:DO:DOUNTILA$(I,X)=C$(A):I=I+1:IFI=OPTHENI=1
5152 LOOP
5155 C%(A)=I:A=A+1:LOOPWHILEA<OP
5170 TT=TI:PRINTUSING"   œ.À. ...  ‘EMPO IMPIEGATO : ##  MINUTI,  ##.#  SECOND
I";(TT-TF)/3600,(TT-TF)/60-INT((TT-TF)/3600)*60
5175 CLOSE1:DOPEN#2,"ARCH-AGENDA ORD",L10:FORI=1TOOP-1:RECORD#2,I:PRINT#2,C%(I):
NEXT:DCLOSE#2:DOPEN#1,"ARCH-AGENDA",L254
5180 SLEEP3:GOTO300
5999 END
6000 REM CALL
6010 PRINTTAB(30)"√»…¡Õ¡ ’Œ ŒœÕ…Œ¡‘…÷œ":WINDOW0,2,79,23,1
6020 PRINT"  –“≈Õ…:
6030 PRINT" < ∆1 >  PER COMPORRE UN NUMERO PRESENTE IN ARCHIVIO
6040 PRINT" < ∆3 >  PER COMPORRE UN NUMERO INSERITO DA TASTIERA
6050 DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135)
6060 IFA$=CHR$(133)THEN6200
6070 PRINT"ì"TAB(25)CHR$(142)"’¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿…"
6080 PRINTTAB(25)"›"TAB(53)"›
6090 PRINTTAB(25)" ¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿À"CHR$(14)
6100 PRINT""TAB(20)"√œÕ–œŒ… …Ã Œ’Õ≈“œ ƒ… ‘≈Ã≈∆œŒœ ƒ≈”…ƒ≈“¡‘œ
6110 CHAR,39,4,"><
6120 T$="":TT=0:DO:GETKEYB$
6122 IFB$=CHR$(20)THENBEGIN:IFT$<>""THENT$=LEFT$(T$,LEN(T$)-1):TT=TT-1:CHAR,27,4
,"                         "zELSEPRINT"";:BEND
6124 IFB$>="0"ANDB$<="9"THENBEGIN:IFTT<25THENT$=T$+B$:TT=TT+1:CHAR,27,4,"
                  ":ELSEPRINT"";:BEND
6126 CHAR,39-LEN(T$)/2,4,">"+T$+"<"
6128 LOOPUNTILB$=CHR$(13)
6129 CHAR,2,13,"”TO COMPONENDO IL NUMERO "+T$+CHR$(143)
6130 FORY=1TOLEN(T$)
6135 PO=ASC(MID$(T$,Y,1))-48
6140 FORX=1TOPO-10*(PO=0)
6150 POKE56577,1:FORK=1TO100:NEXTK:POKE56577,0:FORK=1TO40
6160 PRINT"";:NEXTX:CHAR,27,13,MID$(T$,1,Y)
6170 FORK=1TO250:NEXTK:NEXTY:PRINT:PRINTTAB(17)"... IN LINEA.
6180 CHAR,21,18,"< ∆1 >  PER PROSEGUIRE":CHAR,21,19,"< ∆3 >  PER RIPROVARE LO ST
ESSO NUMERO":CHAR,21,20,"< ∆5 >  PER COMPORRE UN ALTRO NUMERO
6190 DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135)ORA$=CHR$(137):IFA$=CHR$(133
)THEN300:ELSEIFA$=CHR$(135)THEN6129:ELSEGOTO6070
6200 PRINT"ì"
6220 CHAR,5,19,"…NSERISCI I DATI CONOSCIUTI SULL'ABBONATO:
6225 FORX=0TO6:A$(301,X)="":NEXT
6230 GOSUB1805
6240 PRINT""TAB(22);:VA%=26:GOSUB500:PRINT:IFFLTHENA$(301,0)=T$
6250 PRINT""TAB(22);:VA%=31:GOSUB500:PRINT:IFFLTHENA$(301,1)=T$
6252 IFT$=""THEN6260
6254 PO=ASC(T$)
6256 IFPO>191THEN6260
6258 A$(301,1)=CHR$(PO+128)+RIGHT$(T$,LEN(T$)-1)
6260 PRINT""TAB(22);:VA%=41:GOSUB500:PRINT:IFFLTHENA$(301,2)=T$
6270 PRINT""TAB(22);:VA%=26:GOSUB500:PRINT:IFFLTHENA$(301,3)=T$
6280 PRINT""TAB(22);:VA%=21:GOSUB500:PRINT:IFFLTHENA$(301,4)=T$
6290 PRINT""TAB(22);:VA%=51:GOSUB500:PRINT:IFFLTHENA$(301,5)=T$
6300 PRINT""TAB(22);:VA%=51:GOSUB500:PRINT:IFFLTHENA$(301,6)=T$
6310 DO:CHAR,5,19,CHR$(27)+"@√ONFERMI (SI/NO)"+CHR$(143)+"         ùùù":VA%=2:G
OSUB500:LOOPUNTILT$="SI"ORT$="NO":H$=T$:PRINT
6330 FL=0:FORR=1TOOP
6340 IFA$(301,0)<>""THENIFA$(301,0)<>A$(R,0)THEN6410
6350 IFA$(301,1)<>""THENIFA$(301,1)<>A$(R,1)THEN6410
6360 IFA$(301,2)<>""THENIFA$(301,2)<>A$(R,2)THEN6410
6370 IFA$(301,3)<>""THENIFA$(301,3)<>A$(R,3)THEN6410
6380 IFA$(301,4)<>""THENIFA$(301,4)<>A$(R,4)THEN6410
6390 IFA$(301,5)<>""THENIFA$(301,5)<>A$(R,5)THEN6410
6400 IFA$(301,6)<>""THENIFA$(301,6)<>A$(R,6)THEN6410
6402 FL=1:GOSUB2800
6404 CHAR,5,18,"< ∆1 > PER TELEFONARE":CHAR,5,19,"< ∆3 > PER PROSEGUIRE LA RICER
CA":DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135)
6406 IFA$=CHR$(135)THENCHAR,5,19,CHR$(27)+"@":ELSEGOTO6440
6410 NEXTR
6420 CHAR,5,19,"∆…Œ≈ ƒ≈ÃÃ¡ “…√≈“√¡               "
6425 IFFL=0THENCHAR,5,20,"¡‘‘≈Œ⁄…œŒ≈: "+CHR$(143)+"…L NOMINATIVO NON E' PRESENT
E
6430 SLEEP3:CHAR,5,19,CHR$(27)+"@"+"< ∆1 > PER RIPROVARE":CHAR,5,20,"< ∆3 > PER
PROSEGUIRE
6435 DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135):IFA$=CHR$(135)THEN300
6436 CHAR,5,19,"…NSERISCI I DATI CONOSCIUTI SULL'ABBONATO:"+CHR$(27)+"@"
6437 R=301:GOSUB2805:GOTO6240
6440 T$=A$(R,4)
6450 CHAR,2,18,CHR$(27)+"@ ”TO COMPONENDO IL NUMERO  "+T$+CHR$(143):SLEEP1
6460 FORY=1TOLEN(T$)
6470 PO=ASC(MID$(T$,Y,1))-48
6475 IFPO<0ORPO>9THEN6515
6480 FORX=1TOPO-10*(PO=0)
6490 POKE56577,1:FORK=1TO100:NEXTK:POKE56577,0:FORK=1TO40
6500 PRINT"";:NEXTX:CHAR,29,18,MID$(T$,1,Y)
6510 FORK=1TO250:NEXTK
6515 NEXTY:PRINT"  ... IN LINEA.
6520 SLEEP3:CHAR,1,18,CHR$(27)+"@    < ∆1 >  PER PROSEGUIRE":CHAR,5,19,"< ∆3 >
PER RIPROVARE LO STESSO NUMERO"
6530 DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135):IFA$=CHR$(133)THEN300:ELSEG
OTO6450
6999 END
7000 REM HELP
7010 PRINTTAB(30)"”≈””…œŒ≈ ƒ… ¡…’‘œ # 01":WINDOW0,2,79,23,1
7999 END
8000 REM END
8010 PRINTTAB(34)"∆…Œ≈ ƒ≈Ã Ã¡÷œ“œ":WINDOW0,2,79,23,1
8020 PRINT"ì–“≈Õ…:
8030 IFSV=0THENPRINTTAB(12)"< ∆1 >  PER SALVARE L'ARCHIVIO"
8040 PRINTTAB(12)"< ∆3 >  PER TERMINARE COSI'
8050 DO:GETKEYA$:LOOPUNTILA$=CHR$(133)ORA$=CHR$(135)
8060 IFA$=CHR$(133)THENGOSUB8800:GOTO8020
8070 PRINT"ì”EI ”…√’“œ DI VOLER TERMINARE ? (SI/NO)  ";:DO:VA%=2:GOSUB
500:LOOPUNTILT$="SI"ORT$="NO"
8080 IFT$="SI"THENSLEEP2:WINDOW0,0,79,24,1:PRINT"ÕEMORIA LIBERA = "FRE(0)+FRE(1)
"BYTES":PRINT"œK":GOSUB21000:DCLOSE#1:DOPEN#1,"ARCH-AGENDA Q.TY",L10:PRINT#1,O
P:DCLOSE#1:END
8090 SV=0:GOTO300
8800 REM SUBR SAVE
8805 SV=1:SCRATCH"ARCH-AG*
8807 CLOSE1:DOPEN#1,"ARCH-AGENDA Q.TY",L10:PRINT#1,OP:DCLOSE#1
8810 DOPEN#1,"ARCH-AGENDA",L254
8820 FORI=1TOOP-1
8830 FORX=0TO6:RECORD#1,I,RN(X)
8840 UI$=A$(I,X):GOSUB20:PRINT#1,UI$
8850 NEXTX
8860 PRINTI:NEXTI
8870 DCLOSE#1
8875 DOPEN#1,"ARCH-AGENDA ORD",L10:FORI=1TOOP-1:RECORD#1,I:PRINT#1,C%(I):NEXT:DC
LOSE#1
8880 PRINT""TAB(30)"ŒOMINATIVI  MEMORIZZATI
8890 SLEEP3:RETURN
8999 END
10000 REM SUBR LOAD
10005 DOPEN#1,"ARCH-AGENDA Q.TY",L10:INPUT#1,OP:DCLOSE#1
10007 DOPEN#1,"ARCH-AGENDA ORD",L10:FORI=1TOOP-1:RECORD#1,I:INPUT#1,C%(I):NEXT:D
CLOSE#1
10010 DOPEN#1,"ARCH-AGENDA",L254
10018 FORI=1TOOP-1
10020 PRINT"ì ÃOADING  IN  PROGRESS ... "I
10040 FORK=0TO6:RECORD#1,I,RN(K):INPUT#1,A$(I,K):NEXTK
10060 NEXTI
10100 RETURN
20000 IFER<>30THENPRINT"◊¡“Œ…Œ« !        "ERR$(ER)" ERROR IN LINE "EL:RESUMENEX
T
20010 DO:INPUT"ì”EI ”…√’“œ DI VOLER TERMINARE IL LAVORO ? (SI/NO)";T$:LOOPUNTI
LT$="SI"ORT$="NO"
20020 IFT$="NO"THENSCNCLR:RESUMENEXT
20030 GOTO8080
21000 RESTORE21000:FORI=1TO8:READA$:KEYI,A$+CHR$(13):NEXT:RETURN:DATAGRAPHIC,DLO
AD,DIRECTORY,SCNCLR,DSAVE,RUN,LIST,MONITOR

